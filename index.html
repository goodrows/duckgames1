<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Retro Rocket Dodger</title>
  <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet" />
  <style>
    html, body {
      margin: 0; padding: 0; overflow: hidden;
      background: #000;
      font-family: 'Press Start 2P', cursive;
      user-select: none;
      height: 100%;
      width: 100%;
      color: #00FF00;
    }
    #gameArea {
      position: relative;
      width: 100vw;
      height: 100vh;
      background: #000;
      border: 4px solid #00FF00;
      box-sizing: border-box;
      image-rendering: pixelated;
      overflow: hidden;
    }
    #rocket {
      position: absolute;
      width: 40px;
      height: 60px;
      background: #FF0000;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      border: 2px solid #880000;
      box-sizing: border-box;
      image-rendering: pixelated;
    }
    .bullet {
      position: absolute;
      width: 10px;
      height: 20px;
      background: #FFFF00;
      border: 1.5px solid #888800;
      box-sizing: border-box;
      image-rendering: pixelated;
    }
    .powerup {
      position: absolute;
      width: 22px;
      height: 22px;
      box-sizing: border-box;
      border: 3px solid #00FF00;
      image-rendering: pixelated;
    }
    .shield {
      background: #00FFFF;
      border-color: #008888;
    }
    .points {
      background: #00FF00;
      border-color: #008800;
    }
    .speed {
      background: #FF8800;
      border-color: #885500;
    }
    .freeze {
      background: #0000FF;
      border-color: #000088;
    }
    .life {
      background: #FF00FF;
      border-color: #880088;
    }

    #scoreboard {
      position: absolute;
      top: 10px;
      left: 10px;
      background: #000;
      padding: 10px 16px;
      border: 3px solid #00FF00;
      font-size: 14px;
      letter-spacing: 1.2px;
      user-select: none;
      white-space: nowrap;
      z-index: 10;
      image-rendering: pixelated;
    }
    #buttons {
      position: absolute;
      top: 10px;
      right: 10px;
      z-index: 10;
    }
    #buttons button {
      font-family: 'Press Start 2P', cursive;
      font-size: 14px;
      margin-left: 10px;
      padding: 8px 14px;
      cursor: pointer;
      background: #000;
      color: #00FF00;
      border: 3px solid #00FF00;
      text-transform: uppercase;
      user-select: none;
      image-rendering: pixelated;
      transition: background 0.2s;
    }
    #buttons button:hover {
      background: #00FF00;
      color: #000;
    }
    #mobileControls {
      position: absolute;
      bottom: 60px;
      left: 0;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 40px;
      z-index: 10;
    }
    #mobileControls button {
      width: 80px;
      height: 80px;
      font-size: 42px;
      background: #000;
      color: #00FF00;
      border: 4px solid #00FF00;
      cursor: pointer;
      user-select: none;
      image-rendering: pixelated;
      font-weight: bold;
      line-height: 1;
      transition: background 0.2s;
    }
    #mobileControls button:active {
      background: #00FF00;
      color: #000;
    }
    #powerupNote {
      position: absolute;
      top: 50px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 14px;
      color: #FFFF00;
      text-shadow:
        -1px -1px 0 #000,
        1px -1px 0 #000,
        -1px 1px 0 #000,
        1px 1px 0 #000;
      z-index: 10;
      pointer-events: none;
      user-select: none;
      white-space: nowrap;
      letter-spacing: 1.5px;
      font-weight: bold;
      font-family: 'Press Start 2P', cursive;
    }
  </style>
</head>
<body>
  <div id="gameArea">
    <div id="rocket"></div>
    <div id="scoreboard">
      SCORE: <span id="score">0</span> &nbsp;|&nbsp;
      HIGH: <span id="highScore">0</span> &nbsp;|&nbsp;
      LIVES: <span id="lives">3</span> &nbsp;|&nbsp;
      LEVEL: <span id="level">1</span>
    </div>
    <div id="powerupNote"></div>
    <div id="buttons">
      <button id="retryBtn" style="display:none;">RETRY</button>
      <button id="pauseBtn">PAUSE</button>
    </div>
    <div id="mobileControls">
      <button id="leftBtn">◄</button>
      <button id="rightBtn">►</button>
    </div>
  </div>

  <audio id="powerupSound" src="https://cdn.pixabay.com/audio/2022/03/24/audio_c1c86c017f.mp3"></audio>
  <audio id="hitSound" src="https://cdn.pixabay.com/audio/2022/03/21/audio_127f20a1e6.mp3"></audio>

<script>
(() => {
  const rocket = document.getElementById("rocket");
  const gameArea = document.getElementById("gameArea");
  const scoreEl = document.getElementById("score");
  const highScoreEl = document.getElementById("highScore");
  const livesEl = document.getElementById("lives");
  const levelEl = document.getElementById("level");
  const retryBtn = document.getElementById("retryBtn");
  const pauseBtn = document.getElementById("pauseBtn");
  const powerupNote = document.getElementById("powerupNote");
  const leftBtn = document.getElementById("leftBtn");
  const rightBtn = document.getElementById("rightBtn");

  const powerupSound = document.getElementById("powerupSound");
  const hitSound = document.getElementById("hitSound");

  let bullets = [];
  let powerups = [];
  let score = 0;
  let level = 1;
  let lives = 3;
  let highScore = localStorage.getItem("highScore") || 0;
  let bulletSpeed = 4;
  let rocketSpeed = 10;

  let leftPressed = false;
  let rightPressed = false;
  let isPaused = false;

  let lastSpawnBulletTime = 0;
  let lastSpawnPowerupTime = 0;

  let shieldActive = false;
  let doublePointsActive = false;
  let speedBoostActive = false;
  let freezeBulletsActive = false;
  let freezeTimeout;

  highScoreEl.textContent = highScore;

  function updateScore() {
    scoreEl.textContent = score;
    levelEl.textContent = level;
    livesEl.textContent = lives;
  }

  function spawnBullet() {
    const bullet = document.createElement("div");
    bullet.className = "bullet";
    const x = Math.floor(Math.random() * (window.innerWidth - 10));
    bullet.style.left = x + "px";
    bullet.style.top = "0px";
    gameArea.appendChild(bullet);
    bullets.push({ el: bullet, x, y: 0 });
  }

  function showPowerupNotification(text) {
    powerupNote.textContent = text;
    setTimeout(() => {
      if (powerupNote.textContent === text) powerupNote.textContent = "";
    }, 3000);
  }

  const powerupTypes = [
    {
      name: "Shield",
      class: "shield",
      activate() {
        shieldActive = true;
        showPowerupNotification("SHIELD ACTIVATED!");
        powerupSound.play();
        setTimeout(() => {
          shieldActive = false;
          showPowerupNotification("SHIELD WORE OFF");
        }, 5000);
        return true;
      }
    },
    {
      name: "Double Points",
      class: "points",
      activate() {
        if (doublePointsActive) return false;
        doublePointsActive = true;
        showPowerupNotification("DOUBLE POINTS!");
        powerupSound.play();
        setTimeout(() => {
          doublePointsActive = false;
          showPowerupNotification("DOUBLE POINTS ENDED");
        }, 10000);
        return true;
      }
    },
    {
      name: "Speed Boost",
      class: "speed",
      activate() {
        if (speedBoostActive) return false;
        rocketSpeed = 18;
        speedBoostActive = true;
        showPowerupNotification("SPEED BOOST!");
        powerupSound.play();
        setTimeout(() => {
          rocketSpeed = 10;
          speedBoostActive = false;
          showPowerupNotification("SPEED NORMAL");
        }, 6000);
        return true;
      }
    },
    {
      name: "Freeze Bullets",
      class: "freeze",
      activate() {
        if (freezeBulletsActive) return false;
        freezeBulletsActive = true;
        showPowerupNotification("BULLETS FROZEN!");
        powerupSound.play();
        freezeTimeout = setTimeout(() => {
          freezeBulletsActive = false;
          showPowerupNotification("BULLETS UNFROZEN");
        }, 4000);
        return true;
      }
    },
    {
      name: "Extra Life",
      class: "life",
      activate() {
        lives++;
        showPowerupNotification("+1 LIFE");
        powerupSound.play();
        updateScore();
        return true;
      }
    }
  ];

  function spawnPowerup() {
    const type = powerupTypes[Math.floor(Math.random() * powerupTypes.length)];
    const p = document.createElement("div");
    p.classList.add("powerup", type.class);
    const x = Math.floor(Math.random() * (window.innerWidth - 22));
    p.style.left = x + "px";
    p.style.top = "0px";
    gameArea.appendChild(p);
    powerups.push({ el: p, type, x, y: 0 });
  }

  function rectsIntersect(r1, r2) {
    return !(r2.left > r1.right ||
             r2.right < r1.left ||
             r2.top > r1.bottom ||
             r2.bottom < r1.top);
  }

  function moveRocket(dx) {
    const left = rocket.offsetLeft + dx;
    const maxLeft = window.innerWidth - rocket.offsetWidth;
    rocket.style.left = Math.min(Math.max(left, 0), maxLeft) + "px";
  }

  function
